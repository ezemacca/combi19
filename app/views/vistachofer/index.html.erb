
<%if usuario_signed_in? && current_usuario.role == "chofer" %>

<h1>Viajes</h1>
<%current_usuario%>
<table class="table">
  <thead>
    <tr>
      <th scope="col">Accion</th>
      <th scope="col">Estado</th>
      <th scope="col">Fecha y hora</th>
      <th scope="col">Origen</th>
      <th scope="col">Destino</th>
      <th scope="col">Ruta</th>
      <th scope="col">Combi</th>
      <th scope="col">Chofer</th>
      <th scope="col">Pasajeros</th>

    </tr>
  </thead>

  <tbody>
	<% if !@viajeschofer.nil? %>
		<% @viajeschofer.each do |viaje| %>
		    <% if !viaje.eliminado %>
		    		<tr>
				    <%if viaje.fecha < Time.now%>
				       <td><%= link_to 'Iniciar viaje',viaje,class: "btn btn-success btn-sm" %></td>
				    <%else%>
				     	<%if viaje.estado== "en curso"%>
				      		<td><%= link_to 'Finalizar viaje',viaje ,class: "btn btn-success btn-sm" %></td>
						<%else%>
						<td></td>
						<%end%>
					<%end%>
					<% if viaje.estado=="pendiente" || viaje.estado=="en curso"%>
		    	  		<td><%= viaje.estado %></td> 
		    	  	<%end%>
		        	<td><%= viaje.fecha.strftime("%d-%m-%Y %H:%M") %></td>
		        	<td><%= @lugar.find(@ruta.find(viaje.ruta).origen).mostrar_atributos %></td>
		        	<td><%= @lugar.find(@ruta.find(viaje.ruta).destino).mostrar_atributos %></td>
		        	<td><%= @ruta.find(viaje.ruta).mostrar_atributos %></td>
		        	<td><%= @combi.find(viaje.combi).mostrar_atributos %></td>
		        	<td><%= @usuario.mostrar_atributos %></td>
		        	<td><%= link_to 'Pasajeros',viaje ,class: "btn btn-success btn-sm" %></td>
		        </tr>
		    <%end%>
		<%end%>	
	<%end%>


<%end%>